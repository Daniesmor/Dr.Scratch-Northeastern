{% load i18n %}
<html>
    <head>
        <meta http-equiv="content-type" content="text/html; charset=UTF-8">
        <meta name="description" content="Analyze your Scratch projects to assess your Computational Thinking skills">
        <meta name="keywords" content="Stamp, Startup, Multipurpose, Bootstrap, Landing page, Template, Registration, Landing">
        <meta name="author" content="Programamos URJC Libresoft FECyT">
        <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/2.11.6/umd/popper.min.js"></script>
        <link rel="stylesheet" href="../../static/app/content/scratchblocks2.css">
        <!-- <script src="../../static/app/scripts/bootstrap-modal.js"></script> -->
        <script src="../../static/app/scripts/translations.js"></script>
        <!-- <script src="../../static/app/scripts/bootstrap.js"></script> -->
        <link rel="stylesheet" href="../../static/app/content/bootstrap-tour.css">
        <script src="../../static/app/scripts/bootstrap.min.js"></script>
        <script src="../../static/app/scripts/bootstrap-tour.js"></script>
        <script src="../../static/app/scripts/googleAnalytics.js"></script>
        <script src="../../static/app/scripts/scratchblocks-v3.4-min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/party-js@latest/bundle/party.min.js"></script>
    
    
        <!-- SITE TITLE -->
        <title>Dr. Scratch</title>
    
    
        <link rel="stylesheet" href="/static/app/content/style.css">
        <!-- =========================
         FAV AND TOUCH ICONS AND FONT
        ============================== -->
        <link rel="icon" href="/static/app/images/favicon.ico">
        <link rel="stylesheet" href="static/app/icons/icons.css">
        <link type="text/css" rel="stylesheet" href="/static/app/content/css_002.css">
        <link type="text/css" rel="stylesheet" href="/static/app/content/css.css">
        <!-- =========================
         STYLESHEETS
        ============================== -->
        <!-- BOOTSTRAP AND ANIMATION -->
        <link rel="stylesheet" href="/static/app/content/bootstrap.min.css">
        <link rel="stylesheet" href="/static/app/content/animate.css">
    
        <!-- CAROUSEL AND LIGHTBOX -->
        <link rel="stylesheet" href="../../static/app/content/owl_002.css">
        <link rel="stylesheet" href="../../static/app/content/owl.css">
        <link rel="stylesheet" href="../../static/app/content/nivo-lightbox.css">
        <link rel="stylesheet" href="../../static/app/content/default.css">
    
        <!-- CUSTOM STYLESHEETS -->
        <link rel="stylesheet" href="../../static/app/content/styles.css">
        {% if mastery.competence == "Basic" %}
            <link rel="stylesheet" href="/static/app/content/basic.css">
        {% elif mastery.competence == "Developing" %}
            <link rel="stylesheet" href="/static/app/content/developing.css">
        {% elif mastery.competence == "Master" %}
            <link rel="stylesheet" href="/static/app/content/master.css">
        {% elif mastery.competence == "Advanced" %}
            <link rel="stylesheet" href="/static/app/content/advanced.css">
        {% elif mastery.competence == "Finesse" %}
            <link rel="stylesheet" href="/static/app/content/finesse.css">
        {% endif %}

        <!-- RESPONSIVE FIXES -->
        <link rel="stylesheet" href="../../static/app/content/responsive.css">
    
        <!-- DEFAULT COLOR/ CURRENTLY USING -->
        <link rel="stylesheet" href="../../static/app/content/red.css">

        <script>
                window.twttr=(function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],t=window.twttr||{};if(d.getElementById(id))return;js=d.createElement(s);js.id=id;js.src="https://platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);t._e=[];t.ready=function(f){t._e.push(f);};return t;}(document,"script","twitter-wjs"));
        </script>
        <script>
            $(document).ready(function () {
                $('.dropdown').popover();
            });
        </script>
        <script>
            $(document).ready(function() {
                scratchblocks.renderMatching('pre.blocks', {
                style:     'scratch3',   // Optional, defaults to 'scratch2'.
                languages: ['en'], // Optional, defaults to ['en'].
                scale: 0.5,                // Optional, defaults to 1
                });
            })
        </script>
        <script>
            $(document).ready(function () {
                if("{{ dupCode }}" == ""){
                    $("#dupCode").attr("data-content","{% trans 'Your project does not have duplicated scripts, good job!' %}");
                }else{
                    str = "{{ dupCode }}".split(",");
                    for (n in str){
    
                        if(n == 0){str[n] = str[n].slice(13,-11)}
                        else if(n == str.length-1) { str[n] = str[n].slice(14,-12)}
                        else{
                        str[n] = str[n].slice(14,-11)};
                    };
                    $("#dupCode").attr("data-content",str.join("\n"));
                }
            });
        </script>
        <script>
            $(document).ready(function(){
        
            var filename = "{{ filename }}";
            var level = "{{ mastery.points}}/{{ mastery.maxi }}";
            var list =[filename,level];
            $("#certificate").val(list.toString());
            });
        
        </script>
        
        <script>
            $(document).ready(function(){
                var isMouseOverPopover = false;
            
                $('.dropdown').popover({
                    trigger: 'manual',
                    html: true,
                    animation: false
                }).on('mouseenter', function () {
                    var contentId = $(this).attr('id');
                    if (contentId === 'dead-code') {
                        var content = $(this).next('#dead-code-content').html();
                        $(this).attr('data-content', content);
                    } else if (contentId === 'duplicated-scripts') {
                        var content = $(this).next('#duplicated-scripts-content').html();
                        $(this).attr('data-content', content);
                    } else {
                        var _this = this;
                    }
                    $(this).popover('show');
                    $('.popover').on('mouseenter', function () {
                        isMouseOverPopover = true;
                    }).on('mouseleave', function () {
                        isMouseOverPopover = false;
                        $(_this).popover('hide');
                    });
                }).on('mouseleave', function () {
                    var _this = this;
                    setTimeout(function () {
                        if (!isMouseOverPopover) {
                            $(_this).popover('hide');
                        }
                    }, 100);
                });
            });
                
        </script>

        <script>
            function modalContentChange(contentId) {
                var content = document.getElementById(contentId).innerHTML;
                document.getElementById("modalContentChange").innerHTML = content;
                $('#exampleModal').modal('show');
            }
        </script>

        <script>
            $(document).ready(function() {
                $('.progress-bar').each(function() {
                    var progressBar = $(this);
                    var progressValue = parseFloat(progressBar.attr('aria-valuenow'));
                    var maxValue = parseFloat(progressBar.attr('aria-valuemax'));
                    var percentage = (progressValue / maxValue) * 100;
        
                    if (percentage <= 33) {
                        progressBar.removeClass('progress-bar-success progress-bar-warning');
                        progressBar.addClass('progress-bar-danger');
                    } else if (percentage > 33 && percentage <= 66) {
                        progressBar.removeClass('progress-bar-success progress-bar-danger');
                        progressBar.addClass('progress-bar-warning');
                    } else {
                        progressBar.removeClass('progress-bar-danger progress-bar-warning');
                        progressBar.addClass('progress-bar-success');
                    }
                });
            });
        </script>

        <style>
            .btn-primary {
                background-color: #1792A4;
            }
            .btn-primary:hover {
                background-color: #4CA8A1;
            }
            .btn-primary:focus {
                background-color: #4CA8A1;
            }
            .tab {
                overflow: hidden;
                display: flex;
                justify-content: center;
                align-items: center;
            }
            /* Style the buttons that are used to open the tab content */
            .tab button {
            background-color: #fc3b3b;
            color: white;
            font-family: inherit;
            float: left;
            border: none;
            outline: none;
            cursor: pointer;
            padding: 14px 16px;
            transition: 0.3s;
            box-shadow: 0px 4px 8px rgba(0, 0, 0, 0.1);
            border-radius: 6px; 
            background-image: linear-gradient(to bottom, rgba(255, 255, 255, 0.3), rgba(0, 0, 0, 0.1)); 
            margin-right: 20px;
            }
            /* Change background color of buttons on hover */
            .tab button:hover {
            background-color: #d63031;
            }
            /* Create an active/current tablink class */
            .tab button.active {
            background-color: #FF8B8B;
            }
            .bad-smells-title {
                font-size: 3rem;
                font-weight: bold;
                color: #fc3b3b;
                text-align: center;
                padding: 30px 0;
                position: relative;
            }
            .bad-smells-title::before {
                content: "";
                position: absolute;
                left: 0;
                right: 0;
                bottom: -10px;
                height: 10px;
            }
            .bad-smells-title::after {
                content: "";
                position: absolute;
                left: 0;
                right: 0;
                bottom: -10px;
                height: 10px;
            }
            .island {
                margin-bottom: 20px;
            }
            .content {
                display: none;
                position: absolute;
                top: 0;
                left: 0;
                width: 100%;
                background-color: rgba(0, 0, 0, 0.8);
                color: white;
                z-index: 999;
                overflow-y: auto;
                padding: 20px;
                box-sizing: border-box;
            }
            .island img {
                max-width: 100%;
                height: auto;
                cursor: pointer;
            }
            #dashboard .row {
                position: relative;
            }
        </style>    
    
    </head>

    <body>
    <!-- TOP BAR -->
    <div id="wrap">
        <div class="navbar navbar-inverse bs-docs-nav navbar-fixed-top  sticky-navigation" role="navigation">
            <div class="container">
                <div class="navbar-collapse collapse" id="stamp-navigation">
                        <!-- NAVIGATION LINK -->
                    <a class="navbar-brand" href="/">
                        <img src="static/app/images/logo_main.png" alt="">
                    </a>
                    <ul class="nav navbar-nav navbar-right main-navigation ">
                            <li class="navbar-brand"><a class="navbar-brand pull-right" href="https://twitter.com/DrScratchTool"><span class="icon-social-twitter colored-text"></span></a></li>
                            <li class="navbar-brand"><a class="navbar-brand pull-right" href="mailto:kgblll@gsyc.urjc.es"><span class="icon-basic-mail colored-text"></span></a></li>
                            <li class="navbar-brand"><a class="navbar-brand pull-right">{% trans "Dr. Scratch(Beta Version)" %}</a></li>
                    </ul>
                </div>
            </div>
        </div>
        <!-- /END TOP BAR -->
    
        <!-- NAV-MODES -->
        <div class="container" id="stepone">
            <section id="dashboard">
                <!-- NAV-MODES -->
                <div class="tab text-center">
                    <button class="tablinks" onclick="openMode(event, 'Rethinking')">{% trans 'Rethinking Mode' %}</button>
                    <button class="tablinks" onclick="openMode(event, 'Vanilla')">{% trans 'Vanilla Mode' %}</button>
                    <button class="tablinks" onclick="openMode(event, 'Extended')">{% trans 'Extended Mode' %}</button>
                </div>
            </section>
        </div>
              
        <!-- RETHINKING MODE -->
        <div id="Rethinking" class="tabcontent">
            <div class="container" id="steptwo">
                <div class="row d-flex align-items-stretch text-center">
                    <h2 class="bad-smells-title"> {% trans 'Bad Smells World'%} </h2>
                </div>
                <div class="row d-flex align-items-stretch">
                    <!-- World 1: Sprite Naming -->
                    <div class="col-md-3">
                        <div class="island">
                            <h4> {% trans "Sprite Naming" %} </h4>
                            <img src="static/app/images/Isla_1.jpg" alt="Isla 1" onclick="modalContentChange('sprite-naming-content-r')">
                        </div>
                    </div>
                    <!-- World 2: Backdrop Naming -->
                    <div class="col-md-3">
                        <div class="island">
                            <h4> {% trans 'Backdrop Naming' %} </h4>
                            <img src="static/app/images/Isla_2.jpg" alt="Isla 2" onclick="modalContentChange('backdrop-naming-content-r')">
                        </div>
                    </div>
                    <!-- World 3: Dead Code -->
                    <div class="col-md-3">
                        <div class="island">
                            <h4>  {% trans 'Dead Code' %} </h4>
                            <img src="static/app/images/Isla_3.jpg" alt="Isla 3" onclick="modalContentChange('dead-code-content-r')">
                        </div>
                    </div>
                    <!-- World 4: Duplicated Scripts -->
                    <div class="col-md-3">
                        <div class="island">
                            <h4>  {% trans 'Duplicated Scripts' %} </h4>
                            <img src="static/app/images/Isla_4.jpg" alt="Isla 4" onclick="modalContentChange('duplicated-scripts-content-r')">
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- VANILLA MODE -->
        <div id="Vanilla" class="tabcontent">
            {% if mastery_vanilla.competence == "Master" %}
                <div id="confeti-container"></div>
            {% endif %}
            <div class="container">
                <section id="blackboard" class="services col-md-5">
                    <!-- POINTS PANEL -->
                    <div class="devpanel">
                        <div class="panel panel-success" id="devpanel">
                            <div class="panel-heading" id="steptwo" >
                                {% if mastery_vanilla.competence == "Basic" %}
                                    <img src="static/app/images/ferret.png" class="img-responsive col-md-5">
                                {% elif mastery_vanilla.competence == "Developing" %}
                                    <img src="static/app/images/monkey.png" class="img-responsive col-md-4">
                                {% elif mastery_vanilla.competence == "Master" %}
                                    <img src="static/app/images/cat.png" class="img-responsive col-md-3">
                                {% endif %}
                                <h2 id="score" class="panel-title dark-text">
                                    <strong>{% trans "Score:" %}</strong>
                                    {% if mastery_vanilla.points.0|floatformat:"-1" == mastery_vanilla.points.0|floatformat:"0" %}
                                        {{ mastery_vanilla.points.0|floatformat:"0" }}
                                    {% else %}
                                        {{ mastery_vanilla.points.0 }}
                                    {% endif %}
                                    /
                                    {% if mastery_vanilla.points.1|floatformat:"-1" == mastery_vanilla.points.1|floatformat:"0" %}
                                        {{ mastery_vanilla.points.1|floatformat:"0" }}
                                    {% else %}
                                        {{ mastery_vanilla.points.1 }}
                                    {% endif %}                              
                                <a class="twitter-share-button" data-text="{% blocktrans with points=mastery_vanilla.points.0 %} I have just obtained {{ points }} points analyzing my project in Dr. Scratch! Beat it! @DrScratchTool {% endblocktrans %}"href="https://twitter.com/share">Tweet</a></h2>
                            </div>
                            <div class="panel-body">
                                <div class="container col-md-12">
                                    <h3 class='text-left dark-text'>The level of your project is... <strong> {{ mastery_vanilla.competence|upper }}! </strong></h3>
                                    {% if mastery_vanilla.competence == "Basic" %}
                                        <p class='text-left dark-text'> {% trans "You're at the beginning of a <br>great adventure . . . Keep it up!" %}</br></p>
                                    {% elif mastery_vanilla.competence == "Developing" %}
                                        <p class='text-left dark-text'> {% trans "You're doing a great job. Keep it up!!! " %}</p>
                                    {% elif mastery_vanilla.competence == "Master" %}
                                        <p class='text-left dark-text'> {% trans "You're the master of the universe!!! " %}</p>
                                    {% endif %}
                                </div>

                            </div>
                            {% if url != "" %}
                                <a href="{{ url }}" target="_blank"><span class="glyphicon glyphicon-hand-right"></span>{% trans "Come back to your Scratch project." %}</a>
                            {% endif %}
                        </div>
                    </div>
                    {% if mastery_vanilla.competence == "Developing" or mastery_vanilla.competence == "Master" %}
                        <div class="improve">
                            <div class="panel panel-success" id="improve">
                                <div id="stepthree">
                                    <div class="panel-heading" >
                                        <h2 id="score" class="panel-title dark-text">{% trans "Bad habits"%}</h2>
                                    </div>
                                    <div class="panel-body text-left typ">
                                        <a class="glyphicon glyphicon-repeat"/>
                                        <a id="duplicated-scripts" data-html="true" class="dropdown" data-toggle="popover" title="{% trans 'Duplicated scripts' %}" 
                                        data-trigger="manual" href="learn/duplicatedScripts"> 
                                            {{ duplicateScript.number }} {% trans " duplicated scripts." %}
                                        </a>
                                        <div id="duplicated-scripts-content" class="collapse">
                                            <div class="container-fluid">
                                                {% for k, list_duplicate_blocks in duplicateScript.items %}
                                                {% if k == 'scripts' %}
                                                    {% for list_blocks in list_duplicate_blocks %}
                                                        <pre class="blocks">
                                                            {{ list_blocks }}
                                                        </pre>
                                                    {% endfor %}
                                                {% endif %}
                                                {% endfor %}
                                                {% if duplicateScript.number == 0 %}
                                                    {% trans 'Your project does not have duplicated scripts, good job!' %}
                                                {% endif %}
                                            </div>
                                        </div>
                                        <br>
                                        <a class="glyphicon glyphicon-pencil"/>
                                        <a id="bad-smells" data-html="true" class="dropdown" data-toggle="popover" title="{% trans 'Sprite naming' %}" 
                                        data-content="
                                        {% for value in spriteNaming.sprite %}
                                            {{ value }}
                                            <br>
                                        {% endfor %}
                                        {% if spriteNaming.number == 0 %}
                                            {% trans 'Your project does not have default sprite naming, good job!' %}
                                        {% endif %}
                                        " data-trigger="manual" href="learn/spriteNaming"> 
                                            {{ spriteNaming.number }} {% trans " sprite naming." %}
                                        </a><br>
                                        <a class="glyphicon glyphicon-pencil"/> 
                                        <a id="bad-smells" data-html="true" class="dropdown" data-toggle="popover" title="{% trans 'Backdrop naming' %}" data-content="
                                        {% for value in backdropNaming.backdrop %}
                                                {{ value }} <br>
                                        {% endfor %}
                                        {% if backdropNaming.number == 0 %}
                                                {% trans 'Your project does not have default backdrop naming, good job!' %}
                                        {% endif %}
                                            " data-trigger="manual" href="learn/spriteNaming"> 
                                                {{ backdropNaming.number }} {% trans " backdrop naming." %}
                                        </a><br>
                                        <a class="glyphicon glyphicon-remove-sign"/>
                                        <a id="dead-code" data-html="true" class="dropdown" data-toggle="popover" title="{% trans 'Dead code' %}" 
                                        data-trigger="manual" href="learn/deadCode"> 
                                            {{ deadCode.number }} {% trans " dead code." %}
                                        </a>
                                        <div id="dead-code-content" class="collapse">
                                            <div class="container-fluid">
                                                {% for key, value in deadCode.items %}
                                                    {% if key != 'deadCode' %}
                                                        {% if key != 'number' %}
                                                            <b> {{ key }}: </b><br>
                                                            {% for dead_block in value %}
                                                                <pre class="blocks">
                                                                    {{ dead_block }}
                                                                </pre>
                                                            {% endfor %}
                                                            <br>
                                                        {% endif%}
                                                    {% endif%}
                                                {% endfor%}
                                                {% if deadCode.number == 0 %}
                                                    {% trans 'Your project does not have dead code, good job!' %}
                                                {% endif %}
                                            </div>
                                        </div>
                                    </div>
                                    {% if refactor.refactor_list %}
                                        <button type="button" class="btn btn-primary" onclick="modalContentChange('duplicated-scripts-content-r')">
                                            {% trans 'Display all duplicates' %}
                                        </button>
                                    {% endif %}
                                </div>
                            </div>
                        </div>
                    {% endif %}
                    <div class="improve">
                        <div class="panel panel-success" id="improve">
                            <div id="stepfour">
                                <div class="panel-heading" >
                                    <h2 id="score" class="panel-title dark-text">{% trans "Project certificate"%}</h2>
                                </div>
                                <div class="panel-success" style="word-break: break-word;" >
                                    <h5>{{ filename }} <form name="form" class="project-form" enctype="multipart/form-data" method="post" action="/download_certificate">
                                    {% csrf_token %}
                                    <button value="{{ filename }}" name="certificate" type="submit" id ="certificate">{% trans "Download" %}</button>
                                  </form></h5>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>
                <div class="col-md-7">
                    <section id="dashboard">
                        <div class="container-fluid">
                            <div class="row marketing">
                                <div class="jumbotron">
                                    <div class="table-responsive">
                                        <div id="stepfive">
                                            <table class="table tablesorter">
                                                <thead>
                                                    <tr>
                                                    <th><h4>{% trans "Level up" %}</h4></th>
                                                    <th class="col-md-5"><h4>{% trans "Level" %}</h4></th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                
                                                
                                                {% for key, value in mastery_vanilla.items %}
                                                
                                                {% if forloop.counter0|divisibleby:1 %}<tr>{% endif %}
                                                {% if key != "points" %}
                                                {% if key != "competence" %}
                
                                                    <td>
                                                        {% if value.0 == value.1 %}
                                                        <span class="glyphicon glyphicon-star" id="star"></span>
                                                        {% else %}
                                                        <img src="static/app/images/little_bulb.png" alt="">
                                                        {% endif %}
                                                        {% blocktrans %}
                                                        <a href="/learn/{{ key }}/">{{ key }}</a>
                                                        {% endblocktrans %}
                                                    </td>
                                                    <td>
                                                        {% if value.0 == 0 %}
                                                            <div class="progress">
                                                                <div class="progress-bar progress-bar-danger progress-bar-striped" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="{{ value.1 }}" style="width: 0%">
                                                                    <span style="color: grey;"><strong>{{ value.0 }}/{{ value.1 }}</strong></span>
                                                                </div>
                                                            </div>
                                                        {% else %}
                                                            <div class="progress">
                                                                <div id="progressBar" class="progress-bar progress-bar-striped" role="progressbar" aria-valuenow="{{ value.0 }}" aria-valuemin="0" aria-valuemax="{{ value.1 }}" style="width: {% widthratio value.0 value.1 100 %}%">
                                                                    <span><strong>
                                                                        {% if value.0|floatformat:"-1" == value.0|floatformat:"0" %}
                                                                            {{ value.0|floatformat:"0" }}
                                                                        {% else %}
                                                                            {{ value.0 }}
                                                                        {% endif %}
                                                                        /
                                                                        {% if value.1|floatformat:"-1" == value.1|floatformat:"0" %}
                                                                            {{ value.1|floatformat:"0" }}
                                                                        {% else %}
                                                                            {{ value.1 }}
                                                                        {% endif %}
                                                                    </strong></span>                                                                    
                                                                </div>
                                                            </div>
                                                        {% endif %}
                                                    </td>
                                                {% endif %}
                                                {% endif %}
                                                {% if forloop.counter|divisibleby:1 or forloop.last %}
                                                </tr>{% endif %}
                                 
                                                {% endfor %}
                                                </tbody>
                                             </table>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </section>
                </div>
            </div>
        </div>

        <!-- EXTENDED MODE -->
        <div id="Extended" class="tabcontent">
            {% if mastery.competence == "Finesse" %}
                <div id="confeti-container"></div>
            {% endif %}
            <div class="container">
                <section id="blackboard" class="services col-md-5">
                    <!-- POINTS PANEL -->
                    <div class="devpanel">
                        <div class="panel panel-success" id="devpanel">
                            <div class="panel-heading" id="steptwo" >
                                {% if mastery.competence == "Basic" %}
                                    <img src="static/app/images/ferret.png" class="img-responsive col-md-5">
                                {% elif mastery.competence == "Developing" %}
                                    <img src="static/app/images/monkey.png" class="img-responsive col-md-4">
                                {% elif mastery.competence == "Master" %}
                                    <img src="static/app/images/cat.png" class="img-responsive col-md-3">
                                {% elif mastery.competence == "Advanced" %}
                                    <img src="static/app/images/cat.png" class="img-responsive col-md-3">
                                {% elif mastery.competence == "Finesse" %}
                                    <img src="static/app/images/cat.png" class="img-responsive col-md-3">
                                {% endif %}
                                <h2 id="score" class="panel-title dark-text">
                                    <strong>{% trans "Score:" %}</strong>
                                    {% if mastery.points.0|floatformat:"-1" == mastery.points.0|floatformat:"0" %}
                                        {{ mastery.points.0|floatformat:"0" }}
                                    {% else %}
                                        {{ mastery.points.0 }}
                                    {% endif %}
                                    /
                                    {% if mastery.points.1|floatformat:"-1" == mastery.points.1|floatformat:"0" %}
                                        {{ mastery.points.1|floatformat:"0" }}
                                    {% else %}
                                        {{ mastery.points.1 }}
                                    {% endif %}   
                                <a class="twitter-share-button" data-text="{% blocktrans with points=mastery.points.0 %} I have just obtained {{ points }} points analyzing my project in Dr. Scratch! Beat it! @DrScratchTool {% endblocktrans %}"href="https://twitter.com/share">Tweet</a></h2>
                            </div>
                            <div class="panel-body">
                                <div class="container col-md-12">
                                    <h3 class='text-left dark-text'>The level of your project is... <strong> {{ mastery.competence|upper }}! </strong></h3>
                                    {% if mastery.competence == "Basic" %}
                                        <p class='text-left dark-text'> {% trans "You're at the beginning of a <br>great adventure . . . Keep it up!" %}</br></p>
                                    {% elif mastery.competence == "Developing" %}
                                        <p class='text-left dark-text'> {% trans "You're doing a great job. Keep it up!!! " %}</p>
                                    {% elif mastery.competence == "Master" %}
                                        <p class='text-left dark-text'> {% trans "You're the master of the universe!!! " %}</p>
                                    {% elif mastery.competence == "Advanced" %}
                                        <p class='text-left dark-text'> {% trans "You're doing a great job. Keep it up!!! " %}</p>
                                    {% elif mastery.competence == "Finesse" %}
                                        <p class='text-left dark-text'> {% trans "You're doing a great job. Keep it up!!! " %}</p>
                                    {% endif %}
                                </div>

                            </div>
                            {% if url != "" %}
                                <a href="{{ url }}" target="_blank"><span class="glyphicon glyphicon-hand-right"></span>{% trans "Come back to your Scratch project." %}</a>
                            {% endif %}
                        </div>
                    </div>
                    {% if mastery.competence != "Basic" %}
                        <div class="improve">
                            <div class="panel panel-success" id="improve">
                                <div id="stepthree">
                                    <div class="panel-heading" >
                                        <h2 id="score" class="panel-title dark-text">{% trans "Bad habits"%}</h2>
                                    </div>
                                    <div class="panel-body text-left typ">
                                        <a class="glyphicon glyphicon-repeat"/>
                                        <a id="duplicated-scripts" data-html="true" class="dropdown" data-toggle="popover" title="{% trans 'Duplicated scripts' %}" 
                                        data-trigger="manual" href="learn/duplicatedScripts"> 
                                            {{ duplicateScript.number }} {% trans " duplicated scripts." %}
                                        </a>
                                        <div id="duplicated-scripts-content" class="collapse">
                                            <div class="container-fluid">
                                                {% for k, list_duplicate_blocks in duplicateScript.items %}
                                                {% if k == 'scripts' %}
                                                    {% for list_blocks in list_duplicate_blocks %}
                                                        <pre class="blocks">
                                                            {{ list_blocks }}
                                                        </pre>
                                                    {% endfor %}
                                                {% endif %}
                                                {% endfor %}
                                                {% if duplicateScript.number == 0 %}
                                                    {% trans 'Your project does not have duplicated scripts, good job!' %}
                                                {% endif %}
                                            </div>
                                        </div>
                                        <br>
                                        <a class="glyphicon glyphicon-pencil"/>
                                        <a id="bad-smells" data-html="true" class="dropdown" data-toggle="popover" title="{% trans 'Sprite naming' %}" 
                                        data-content="
                                        {% for value in spriteNaming.sprite %}
                                            {{ value }}
                                            <br>
                                        {% endfor %}
                                        {% if spriteNaming.number == 0 %}
                                            {% trans 'Your project does not have default sprite naming, good job!' %}
                                        {% endif %}
                                        " data-trigger="manual" href="learn/spriteNaming"> 
                                            {{ spriteNaming.number }} {% trans " sprite naming." %}
                                        </a><br>
                                        <a class="glyphicon glyphicon-pencil"/> 
                                        <a id="bad-smells" data-html="true" class="dropdown" data-toggle="popover" title="{% trans 'Backdrop naming' %}" data-content="
                                        {% for value in backdropNaming.backdrop %}
                                                {{ value }} <br>
                                        {% endfor %}
                                        {% if backdropNaming.number == 0 %}
                                                {% trans 'Your project does not have default backdrop naming, good job!' %}
                                        {% endif %}
                                            " data-trigger="manual" href="learn/spriteNaming"> 
                                                {{ backdropNaming.number }} {% trans " backdrop naming." %}
                                        </a><br>
                                        <a class="glyphicon glyphicon-remove-sign"/>
                                        <a id="dead-code" data-html="true" class="dropdown" data-toggle="popover" title="{% trans 'Dead code' %}" 
                                        data-trigger="manual" href="learn/deadCode"> 
                                            {{ deadCode.number }} {% trans " dead code." %}
                                        </a>
                                        <div id="dead-code-content" class="collapse">
                                            <div class="container-fluid">
                                                {% for key, value in deadCode.items %}
                                                    {% if key != 'deadCode' %}
                                                        {% if key != 'number' %}
                                                            <b> {{ key }}: </b><br>
                                                            {% for dead_block in value %}
                                                                <pre class="blocks">
                                                                    {{ dead_block }}
                                                                </pre>
                                                            {% endfor %}
                                                            <br>
                                                        {% endif%}
                                                    {% endif%}
                                                {% endfor%}
                                                {% if deadCode.number == 0 %}
                                                    {% trans 'Your project does not have dead code, good job!' %}
                                                {% endif %}
                                            </div>
                                        </div>
                                    </div>
                                    {% if refactor.refactor_list %}
                                        <button type="button" class="btn btn-primary" onclick="modalContentChange('duplicated-scripts-content-r')">
                                            {% trans 'Display all duplicates' %}
                                        </button>
                                    {% endif %}
                                </div>
                            </div>
                        </div>
                    {% endif %}
                    <div class="improve">
                        <div class="panel panel-success" id="improve">
                            <div id="stepfour">
                                <div class="panel-heading" >
                                    <h2 id="score" class="panel-title dark-text">{% trans "Project certificate"%}</h2>
                                </div>
                                <div class="panel-success" style="word-break: break-word;" >
                                    <h5>{{ filename }} <form name="form" class="project-form" enctype="multipart/form-data" method="post" action="/download_certificate">
                                    {% csrf_token %}
                                    <button value="{{ filename }}" name="certificate" type="submit" id ="certificate">{% trans "Download" %}</button>
                                  </form></h5>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>
                <div class="col-md-7">
                    <section id="dashboard">
                        <div class="container-fluid">
                            <div class="row marketing">
                                <div class="jumbotron">
                                    <div class="table-responsive">
                                        <div id="stepfive">
                                            <table class="table tablesorter">
                                                <thead>
                                                    <tr>
                                                    <th><h4>{% trans "Level up" %}</h4></th>
                                                    <th class="col-md-5"><h4>{% trans "Level" %}</h4></th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                
                                                
                                                {% for key, value in mastery.items %}
                                                
                                                {% if forloop.counter0|divisibleby:1 %}<tr>{% endif %}
                                                {% if key != "points" %}
                                                {% if key != "competence" %}
                
                                                    <td>
                                                        {% if value.0 == value.1 %}
                                                        <span class="glyphicon glyphicon-star" id="star"></span>
                                                        {% else %}
                                                        <img src="static/app/images/little_bulb.png" alt="">
                                                        {% endif %}
                                                        {% blocktrans %}
                                                        <a href="/learn/{{ key }}/">{{ key }}</a>
                                                        {% endblocktrans %}
                                                    </td>
                                                    <td>
                                                        {% if value.0 == 0 %}
                                                            <div class="progress">
                                                                <div class="progress-bar progress-bar-danger progress-bar-striped" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="{{ value.1 }}" style="width: 0%">
                                                                    <span style="color: grey;"><strong>{{ value.0 }}/{{ value.1 }}</strong></span>
                                                                </div>
                                                            </div>
                                                        {% else %}
                                                            <div class="progress">
                                                                <div id="progressBar" class="progress-bar progress-bar-striped" role="progressbar" aria-valuenow="{{ value.0 }}" aria-valuemin="0" aria-valuemax="{{ value.1 }}" style="width: {% widthratio value.0 value.1 100 %}%">
                                                                    <span><strong>
                                                                        {% if value.0|floatformat:"-1" == value.0|floatformat:"0" %}
                                                                            {{ value.0|floatformat:"0" }}
                                                                        {% else %}
                                                                            {{ value.0 }}
                                                                        {% endif %}
                                                                        /
                                                                        {% if value.1|floatformat:"-1" == value.1|floatformat:"0" %}
                                                                            {{ value.1|floatformat:"0" }}
                                                                        {% else %}
                                                                            {{ value.1 }}
                                                                        {% endif %}
                                                                    </strong></span>
                                                                    
                                                                </div>
                                                            </div>
                                                        {% endif %}
                                                    </td>
                                                {% endif %}
                                                {% endif %}
                                                {% if forloop.counter|divisibleby:1 or forloop.last %}
                                                </tr>{% endif %}
                                 
                                                {% endfor %}
                                                </tbody>
                                             </table>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </section>
                </div>
            </div>
        </div>

        

        <!-- MODAL -->
        <div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
            <div class="modal-dialog modal-xl modal-dialog-scrollable" role="document">
                <div class="modal-content" id="modalContentChange"></div>
            </div>
        </div>

        <div id="duplicated-scripts-content-r" style="display: none;">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">Duplicates</h5>
            </div>
            <div class="modal-body">
                <div class="container-fluid">
                    {% if duplicateScript.number == 0 %}
                        <p> {% trans 'Your project does not have duplicated scripts, good job!' %}
                    {% else %}
                        <div class="card" id="refactorization">
                            {% for refactor_dict in refactor.refactor_list %}
                            <p>
                            <div class="row">
                                <div class="col-md-6">
                                    <button class="btn btn-primary" type="button" data-toggle="collapse" data-target="#originalCollapse{{ forloop.counter }}" aria-expanded="false" aria-controls="originalCollapse{{ forloop.counter }}">
                                        Display Original Blocks!
                                    </button>
                                </div>
                                <div class="col-md-6">
                                    <button class="btn btn-primary" type="button" data-toggle="collapse" data-target="#refactoredCollapse{{ forloop.counter }}" aria-expanded="false" aria-controls="refactoredCollapse{{ forloop.counter }}">
                                        Display Solution!
                                    </button>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="collapse" id="originalCollapse{{ forloop.counter }}" data-bs-parent="#refactorization">
                                        <div class="card card-body">
                                            <pre class="blocks">
                                                {{ refactor_dict.original }}
                                            </pre>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="collapse" id="refactoredCollapse{{ forloop.counter }}" data-bs-parent="#refactorization">
                                        <div class="card card-body">
                                            <pre class="blocks">
                                                {{ refactor_dict.refactored }}
                                            </pre>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </p>
                            {% endfor %}
                        </div>
                    {% endif %}
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-primary" data-dismiss="modal">Close</button>
            </div>
        </div>

        <div id="sprite-naming-content-r" style="display: none;">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">Sprite Naming</h5>
            </div>
            <div class="modal-body">
                <div class="container-fluid">
                    {% if spriteNaming.number == 0 %}
                        <p> {% trans 'Your project does not have default sprite naming, good job!' %}
                    {% else %}
                        <div class="card" id="refactorization">
                            <div class="row">
                                <div class="col-md-6">
                                    <button class="btn btn-primary" type="button" data-toggle="collapse" data-target="#originalCollapse" aria-expanded="false" aria-controls="originalCollapse">
                                        Display Original Names!
                                    </button>
                                </div>
                                <div class="col-md-6">
                                    <button class="btn btn-primary" type="button" data-toggle="collapse" data-target="#refactoredCollapse" aria-expanded="false" aria-controls="refactoredCollapse">
                                        Display Solution!
                                    </button>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="collapse" id="originalCollapse" data-bs-parent="#refactorization">
                                        <div class="card card-body">
                                            {% for value in spriteNaming.sprite %}
                                                <p> {{ value }} </p>
                                            {% endfor %}
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="collapse" id="refactoredCollapse" data-bs-parent="#refactorization">
                                        <div class="card card-body">
                                            <p> {% trans 'Try to name them more according to the Function they make' %} </p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    {% endif %}
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-primary" data-dismiss="modal">Close</button>
            </div>
        </div>

        <div id="backdrop-naming-content-r" style="display: none;">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">Backdrop Naming</h5>
            </div>
            <div class="modal-body">
                <div class="container-fluid">
                    {% if backdropNaming.number == 0 %}
                        <p> {% trans 'Your project does not have default backdrop naming, good job!' %}
                    {% else %}
                        <div class="card" id="refactorization">
                            <div class="row">
                                <div class="col-md-6">
                                    <button class="btn btn-primary" type="button" data-toggle="collapse" data-target="#originalCollapse" aria-expanded="false" aria-controls="originalCollapse">
                                        Display Original Names!
                                    </button>
                                </div>
                                <div class="col-md-6">
                                    <button class="btn btn-primary" type="button" data-toggle="collapse" data-target="#refactoredCollapse" aria-expanded="false" aria-controls="refactoredCollapse">
                                        Display Solution!
                                    </button>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="collapse" id="originalCollapse" data-bs-parent="#refactorization">
                                        <div class="card card-body">
                                            {% for value in backdropNaming.backdrop %}
                                                <p> {{ value }} </p>
                                            {% endfor %}
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="collapse" id="refactoredCollapse" data-bs-parent="#refactorization">
                                        <div class="card card-body">
                                            <p> {% trans 'Try to name them more according to the Function they make' %} </p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    {% endif %}
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-primary" data-dismiss="modal">Close</button>
            </div>
        </div>

        <div id="dead-code-content-r" style="display: none;">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">Dead Code</h5>
            </div>
            <div class="modal-body">
                <div class="container-fluid">
                    {% if deadCode.number == 0 %}
                        <p> {% trans 'Your project does not have dead code, good job!' %}
                    {% else %}
                        <div class="card" id="refactorization">
                            <div class="row">
                                <div class="col-md-6">
                                    <button class="btn btn-primary" type="button" data-toggle="collapse" data-target="#originalCollapse" aria-expanded="false" aria-controls="originalCollapse">
                                        Display Original Blocks!
                                    </button>
                                </div>
                                <div class="col-md-6">
                                    <button class="btn btn-primary" type="button" data-toggle="collapse" data-target="#refactoredCollapse" aria-expanded="false" aria-controls="refactoredCollapse">
                                        Display Solution!
                                    </button>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="collapse" id="originalCollapse" data-bs-parent="#refactorization">
                                        <div class="card card-body">
                                            {% for key, value in deadCode.items %}
                                                {% if key != 'deadCode' %}
                                                    {% if key != 'number' %}
                                                        <p> {{ key }}: </p>
                                                        {% for dead_block in value %}
                                                            <pre class="blocks">
                                                                <p> {{ dead_block }} </p>
                                                            </pre>
                                                        {% endfor %}
                                                    {% endif%}
                                                {% endif%}
                                            {% endfor%}
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="collapse" id="refactoredCollapse" data-bs-parent="#refactorization">
                                        <div class="card card-body">
                                            <p>
                                                {% trans 'Erase them in order to have a cleaner Code' %}
                                            </p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    {% endif %}
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-primary" data-dismiss="modal">Close</button>
            </div>
        </div>

        <!-- FOOTER -->
        <footer class="footer grey-bg">
            <div class="container">
                <p><small>{% trans "© 2019 Dr. Scratch." %} Made with <span style="color: #e25555;">&#9829;</span> by <a href="/collaborators">Dr. Scratch Team</a></small></p>
                <ul class="social-icons">
                    <li><a href="https:/twitter.com/drscratchtool"><span class="icon-font-social-twitter transparent-text-dark"></span></a></li>
                    <li><a href="https://github.com/AngelaVargas/drscratchv3"><span class="icon-font-social-github transparent-text-dark"></span></a></li>
                </ul>
            </div>
        </footer>

        <script>
            // Crear el efecto de confeti
            const confetiContainer = document.getElementById('confeti-container');
            const partyFinesse = new Party(confetiContainer);

            // Configurar el efecto de confeti
            partyFinesse.colors = ['#FF0000', '#00FF00', '#0000FF'];
            partyFinesse.confettiCount = 200;
            partyFinesse.velocity = 3;

            // Lanzar el efecto de confeti
            partyFinesse.start();
        </script>

        <script>
            function openMode(evt, ModeName) {
                // Declare all variables
                var i, tabcontent, tablinks;
                
                // Get all elements with class="tabcontent" and hide them
                tabcontent = document.getElementsByClassName("tabcontent");
                for (i = 0; i < tabcontent.length; i++) {
                    tabcontent[i].style.display = "none";
                }
                
                // Get all elements with class="tablinks" and remove the class "active"
                tablinks = document.getElementsByClassName("tablinks");
                for (i = 0; i < tablinks.length; i++) {
                    tablinks[i].className = tablinks[i].className.replace(" active", "");
                }
                
                // Show the current tab, and add an "active" class to the button that opened the tab
                document.getElementById(ModeName ).style.display = "block";
                evt.currentTarget.className += " active";
            }
        </script>

        <script>
            // Show the Vanilla mode by default
            document.getElementById("Vanilla").style.display = "block";
            // Hide the others content
            document.getElementById("Rethinking").style.display = "none";
            document.getElementById("Extended").style.display = "none";
        </script>

    </body>
</html>